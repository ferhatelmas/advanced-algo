Suppose that we have a directed network that contains one good node $g$ and various bad nodes $b_i$. We consider $g$ to be the source of the network and then we use a virtual node as a sink and we connect all nodes except for $g$ and the nodes that have a out-degree of 0 to the sink.

Starting from the sink, we traverse the graph to search good node in the reverse direction to set comparative costs to edges while applying the following rule:
\begin{itemize}
  \item Set the sink to 0.
  \item If the visited node is a normal node (neither good nor bad), the comparative cost of the edge is the total out-flow of the node. $c_{ij} = \sum \textit{out-flow}_j$
  \item If the visited node is a bad node, the comparative cost of the edge is the total out-flow of the node and 1. $c_{ij} = 1 + \sum \textit{out-flow}_j$
  \item If the visited node is a good node $g$, this part of the algorithms finishes.
\end{itemize}

After getting comparative costs of the edges, we multiply these values with a huge value to prevent the flow from going over bad nodes. This leads us to min-cost max-flow problem and we try to send the flow $d$ from the good node to our virtual node where $d$ is the out-degree of the good node. This can be accomplished in $O(V \cdot E^2) \leq O(V^5)$ complexity by tweaking \textit{Ford-Fulkerson(Edmonds-Karp)} with a guaranteed termination. After the algorithm completes, we find the edge with the highest cost that's not included into the path found by \textit{Ford-Fulkerson} and also has a bad node as an end point. This can easily be done with breadth-first starting from the good node $g$ so complexity is bounded by $O(E)$, but in practice, it will be much lower. When the edge with the given constraints is found, we may remove it according to improvement in $|f(S)| - a \cdot |S|$. The size of $S$ will increase by 1 since we will remove one edge, and to find the change in $|f(S)|$, we can go a search for the virtual node again starting from the good node $g$. If it is improves, we remove preselected edge and continue iterate while applying min-cost max-flow to the graph that has one less edge. Otherwise, we return the current value of the variant.